--- include/linux/ipipe_base.h
+++ include/linux/ipipe_base.h
@@ -179,9 +179,6 @@ static inline void __ipipe_sync_stage(void)
 
 void __ipipe_flush_printk(unsigned int irq, void *cookie);
 
-void __ipipe_pin_range_globally(unsigned long start,
-				unsigned long end);
-
 #define __ipipe_get_cpu(flags)	({ (flags) = hard_preempt_disable(); ipipe_processor_id(); })
 #define __ipipe_put_cpu(flags)	hard_preempt_enable(flags)
 
@@ -314,10 +311,6 @@ static inline void __ipipe_report_cleanup(struct mm_struct *mm) { }
 
 static inline void __ipipe_init_taskinfo(struct task_struct *p) { }
 
-static inline void __ipipe_pin_range_globally(unsigned long start,
-					      unsigned long end)
-{ }
-
 #define hard_preempt_disable()		({ preempt_disable(); 0; })
 #define hard_preempt_enable(flags)	({ preempt_enable(); (void)(flags); })
 
@@ -344,6 +337,15 @@ static inline void ipipe_root_only(void) { }
 
 #endif	/* !CONFIG_IPIPE */
 
+#ifdef CONFIG_IPIPE_WANT_PTE_PINNING
+void __ipipe_pin_mapping_globally(unsigned long start,
+				  unsigned long end);
+#else
+static inline void __ipipe_pin_mapping_globally(unsigned long start,
+						unsigned long end)
+{ }
+#endif
+
 static inline void ipipe_preempt_root_only(void)
 {
 #if defined(CONFIG_IPIPE_DEBUG_CONTEXT) && \
